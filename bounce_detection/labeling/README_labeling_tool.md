# åŠè‡ªåŠ¨æ ‡æ³¨å·¥å…· v2.1

**Semi-automatic Labeling Tool for Bounce Detection**

åŸºäº Phase 1 è§„åˆ™æ£€æµ‹ç»“æœçš„äº¤äº’å¼æ ‡æ³¨å·¥å…·ï¼Œç”¨äºç”Ÿæˆ BounceNet è®­ç»ƒæ•°æ®ã€‚æ”¯æŒè§†é¢‘å¯¼èˆªå’ŒæŸ¥çœ‹æ¨¡å¼ã€‚

> ğŸ“– ç›¸å…³æ–‡æ¡£:
>
> - [æ¨¡å—æ€»è§ˆ](../README.md)
> - [Phase 1 è§„åˆ™æ£€æµ‹](../README_phase1_rules.md)
> - [Phase 2 BounceNet](../README_phase2_bouncenet.md)

---

## å¿«é€Ÿå¼€å§‹

```bash
# 1. æ ‡æ³¨å•ä¸ªæ–‡ä»¶
python labeling_launcher.py --csv data/test/match1/csv/1_05_02_ball.csv

# 2. æ‰¹é‡æ ‡æ³¨ï¼ˆæœªå®Œæˆçš„æ–‡ä»¶ï¼‰
python labeling_launcher.py --match_dir data/test/match1

# 3. æŸ¥çœ‹/ä¿®æ”¹å·²æ ‡æ³¨æ–‡ä»¶
python labeling_launcher.py --match_dir data/test/match1 --review

# 4. åœ¨æ ‡æ³¨å·¥å…·ä¸­ä½¿ç”¨ Ctrl+â†/â†’ å¿«é€Ÿåˆ‡æ¢è§†é¢‘
```

---

## ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [è§†é¢‘å¯¼èˆªåŠŸèƒ½](#è§†é¢‘å¯¼èˆªåŠŸèƒ½-new)
- [æŸ¥çœ‹æ¨¡å¼](#æŸ¥çœ‹æ¨¡å¼-new)
- [ç•Œé¢è¯´æ˜](#ç•Œé¢è¯´æ˜)
- [å¿«æ·é”®](#å¿«æ·é”®)
- [æ•°æ®æ ¼å¼](#æ•°æ®æ ¼å¼)
- [æ‰¹é‡æ ‡æ³¨](#æ‰¹é‡æ ‡æ³¨)
- [å¯¼å‡ºè®­ç»ƒæ•°æ®](#å¯¼å‡ºè®­ç»ƒæ•°æ®)
- [API å‚è€ƒ](#api-å‚è€ƒ)

---

## åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- âœ… **Phase 1 é¢„å¡«å……**: è‡ªåŠ¨è¿è¡Œè§„åˆ™æ£€æµ‹ï¼Œé¢„å¡«å……å€™é€‰äº‹ä»¶
- âœ… **è§†é¢‘å¸§æµè§ˆ**: æ”¯æŒè§†é¢‘å¸§å’Œè½¨è¿¹åŒæ­¥æ˜¾ç¤º
- âœ… **äº‹ä»¶ç¼–è¾‘**: ç¡®è®¤/åˆ é™¤/ä¿®æ”¹/æ·»åŠ äº‹ä»¶
- âœ… **å®æ—¶ç»Ÿè®¡**: æ˜¾ç¤ºæ ‡æ³¨è¿›åº¦å’Œäº‹ä»¶åˆ†å¸ƒ
- âœ… **è‡ªåŠ¨ä¿å­˜**: JSON æ ¼å¼æ ‡æ³¨æ–‡ä»¶
- âœ… **æ‰¹é‡å¤„ç†**: æ”¯æŒæ•´ä¸ª match ç›®å½•çš„è¿ç»­æ ‡æ³¨
- âœ… **æ•°æ®å¯¼å‡º**: å¯¼å‡ºä¸º CSV è®­ç»ƒæ ¼å¼
- âœ… **ç°ä»£åŒ–ç•Œé¢**: æ·±è‰²ä¸»é¢˜ + æ¸…æ™°çš„è§†è§‰åé¦ˆ

### ğŸ†• v2.1 æ–°åŠŸèƒ½

- âœ¨ **è§†é¢‘å¯¼èˆª**: åœ¨matchå†…å¿«é€Ÿåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªè§†é¢‘

  - æŒ‰é’®ï¼š`<< PrevVid` / `NextVid >>`
  - å¿«æ·é”®ï¼š`Ctrl+â†` / `Ctrl+â†’`
  - è‡ªåŠ¨ä¿å­˜å½“å‰æ ‡æ³¨ååˆ‡æ¢
- âœ¨ **Matchä¿¡æ¯æ˜¾ç¤º**: UIå®æ—¶æ˜¾ç¤ºå½“å‰matchå’Œè§†é¢‘ä¿¡æ¯

  - æ˜¾ç¤ºï¼š`Match: match1 | Video: 1_05_02 [1/11]`
  - ä¿¡æ¯é¢æ¿æ˜¾ç¤ºå½“å‰è§†é¢‘åœ¨matchä¸­çš„ä½ç½®
- âœ¨ **æŸ¥çœ‹æ¨¡å¼** (`--review`): æŸ¥çœ‹å’Œä¿®æ”¹å·²å®Œæˆçš„æ ‡æ³¨

  - è‡ªåŠ¨åŠ è½½å·²ä¿å­˜çš„æ ‡æ³¨æ–‡ä»¶
  - ä¸é‡æ–°è¿è¡Œè‡ªåŠ¨æ£€æµ‹
  - æ”¯æŒä¿®æ”¹å’Œé‡æ–°ä¿å­˜
  - è§†é¢‘å¯¼èˆªæ—¶ä¿æŒæŸ¥çœ‹æ¨¡å¼

### äº‹ä»¶ç±»å‹

| ç±»å‹   | æ ‡è¯†             | ç¬¦å· | é¢œè‰²      | å¿«æ·é”® |
| ------ | ---------------- | ---- | --------- | ------ |
| è½åœ°ç‚¹ | `landing`      | â˜…   | ğŸ”´ çŠç‘šçº¢ | L      |
| å‡»çƒç‚¹ | `hit`          | â—†   | ğŸ”µ é’ç»¿è‰² | H      |
| å‡ºç”»é¢ | `out_of_frame` | âœ•   | â¬œ ç°è‰²   | O      |
| å…¶ä»–   | `other`        | â–    | ğŸŸ¡ æ©™é»„è‰² | N      |

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install numpy pandas matplotlib opencv-python
```

### æ ‡æ³¨å•ä¸ªæ–‡ä»¶

```bash
# åŸºæœ¬ç”¨æ³•ï¼ˆè‡ªåŠ¨æŸ¥æ‰¾å¯¹åº”è§†é¢‘ï¼‰
python labeling_launcher.py --csv data/train/match5/csv/1_01_01_ball.csv

# æŒ‡å®šè§†é¢‘æ–‡ä»¶
python labeling_launcher.py --csv data/test/match1/csv/1_05_02_ball.csv \
                            --video data/test/match1/video/1_05_02.mp4

# åŠ è½½å·²æœ‰æ ‡æ³¨ç»§ç»­ç¼–è¾‘
python labeling_launcher.py --csv data/test/match1/csv/1_05_02_ball.csv \
                            --labels data/test/match1/labels/1_05_02_labels.json
```

### æ‰¹é‡æ ‡æ³¨

```bash
# æ ‡æ³¨æ•´ä¸ª match ç›®å½•
python labeling_launcher.py --match_dir data/test/match1

# ğŸ†• æŸ¥çœ‹/ä¿®æ”¹å·²æ ‡æ³¨çš„æ–‡ä»¶ï¼ˆæŸ¥çœ‹æ¨¡å¼ï¼‰
python labeling_launcher.py --match_dir data/test/match1 --review
```

---

## ä½¿ç”¨æŒ‡å—

### æ ‡æ³¨å·¥ä½œæµç¨‹

```
1. å¯åŠ¨å·¥å…·
   â””â”€â”€ è‡ªåŠ¨åŠ è½½ CSV è½¨è¿¹
   â””â”€â”€ è‡ªåŠ¨æŸ¥æ‰¾å¯¹åº”è§†é¢‘
   â””â”€â”€ è‡ªåŠ¨è¿è¡Œ Phase 1 æ£€æµ‹é¢„å¡«å……
   
2. æµè§ˆå€™é€‰äº‹ä»¶
   â””â”€â”€ â†‘/W è·³è½¬åˆ°ä¸Šä¸€ä¸ªäº‹ä»¶
   â””â”€â”€ â†“ è·³è½¬åˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶
   â””â”€â”€ â†/A ä¸Šä¸€å¸§
   â””â”€â”€ â†’/D ä¸‹ä¸€å¸§
   
3. ç¡®è®¤/ä¿®æ­£äº‹ä»¶
   â””â”€â”€ Y ç¡®è®¤å½“å‰äº‹ä»¶
   â””â”€â”€ Delete åˆ é™¤è¯¯æ£€äº‹ä»¶
   â””â”€â”€ L/H/O ä¿®æ”¹äº‹ä»¶ç±»å‹
   
4. è¡¥å……é—æ¼äº‹ä»¶
   â””â”€â”€ å¯¼èˆªåˆ°é—æ¼çš„å¸§
   â””â”€â”€ N æ·»åŠ æ–°äº‹ä»¶ï¼ˆé»˜è®¤ä¸ºè½åœ°ï¼‰
   â””â”€â”€ L/H/O è®¾ç½®ç±»å‹
   
5. ä¿å­˜æ ‡æ³¨
   â””â”€â”€ S / Ctrl+S ä¿å­˜
   â””â”€â”€ Q / Esc é€€å‡º
```

### æ ‡æ³¨æ ‡å‡†

#### Landing (è½åœ°ç‚¹) â˜…

- çƒè½åœ°ååœæ­¢æˆ–æ¶ˆå¤±
- å…¸å‹ç‰¹å¾ï¼šé€Ÿåº¦éª¤é™è‡³æ¥è¿‘é›¶

#### Hit (å‡»çƒç‚¹) â—†

- çƒè¢«çƒæ‹å‡»ä¸­çš„ç¬é—´
- å…¸å‹ç‰¹å¾ï¼šé€Ÿåº¦æ–¹å‘çªç„¶åè½¬ï¼Œé€Ÿåº¦å¤§å°ä¿æŒè¾ƒé«˜

#### Out-of-frame (å‡ºç”»é¢) âœ•

- çƒé£å‡ºç”»é¢è¾¹ç¼˜
- å…¸å‹ä½ç½®ï¼šç”»é¢é¡¶éƒ¨/åº•éƒ¨/ä¸¤ä¾§è¾¹ç¼˜

---

## è§†é¢‘å¯¼èˆªåŠŸèƒ½ ğŸ†•

### æ¦‚è¿°

åœ¨æ ‡æ³¨è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ°åŒä¸€matchä¸­çš„å…¶ä»–è§†é¢‘ï¼Œæ— éœ€é€€å‡ºå·¥å…·é‡æ–°å¯åŠ¨ã€‚

### ä½¿ç”¨æ–¹æ³•

#### æ–¹æ³•1ï¼šä½¿ç”¨æŒ‰é’®

- ç‚¹å‡» `<< PrevVid` æŒ‰é’®åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªè§†é¢‘
- ç‚¹å‡» `NextVid >>` æŒ‰é’®åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè§†é¢‘

#### æ–¹æ³•2ï¼šä½¿ç”¨å¿«æ·é”®ï¼ˆæ¨èï¼‰

- `Ctrl + â†` - åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªè§†é¢‘
- `Ctrl + â†’` - åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè§†é¢‘

### åŠŸèƒ½ç‰¹æ€§

1. **è‡ªåŠ¨ä¿å­˜**

   - åˆ‡æ¢å‰ä¼šæç¤ºä¿å­˜å½“å‰è§†é¢‘çš„ä¿®æ”¹
   - è¾“å…¥ `y` ä¿å­˜ï¼Œ`n` æ”¾å¼ƒä¿®æ”¹
2. **æ™ºèƒ½åŠ è½½**

   - æ™®é€šæ¨¡å¼ï¼šåŠ è½½æ–°è§†é¢‘å¹¶è¿è¡ŒPhase 1æ£€æµ‹
   - æŸ¥çœ‹æ¨¡å¼ï¼šåŠ è½½å·²æœ‰æ ‡æ³¨æ–‡ä»¶ï¼ˆè§ä¸‹æ–‡ï¼‰
3. **Matchä¿¡æ¯æ˜¾ç¤º**

   ```
   ä¿¡æ¯é¢æ¿ï¼š
   MATCH/VIDEO
   Match: match1
   Video: 1_05_02
   [1/11]

   å¯åŠ¨ä¿¡æ¯ï¼š
   Match: match1 | Video: 1_05_02 [1/11]
   ```

   æ˜¾ç¤ºå½“å‰æ˜¯ç¬¬å‡ ä¸ªè§†é¢‘ä»¥åŠmatchä¸­æ€»å…±æœ‰å¤šå°‘ä¸ªè§†é¢‘
4. **è¾¹ç•Œæ£€æµ‹**

   - åœ¨ç¬¬ä¸€ä¸ªè§†é¢‘æ—¶æŒ‰ `Ctrl+â†` æç¤ºï¼š`Already at first video`
   - åœ¨æœ€åä¸€ä¸ªè§†é¢‘æ—¶æŒ‰ `Ctrl+â†’` æç¤ºï¼š`Already at last video`

### å…¸å‹ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šè¿ç»­æ ‡æ³¨å¤šä¸ªè§†é¢‘

```bash
# 1. å¯åŠ¨ç¬¬ä¸€ä¸ªè§†é¢‘
python labeling_launcher.py --csv data/test/match1/csv/1_05_02_ball.csv

# 2. åœ¨æ ‡æ³¨å·¥å…·ä¸­
#    - å®Œæˆå½“å‰è§†é¢‘æ ‡æ³¨
#    - æŒ‰ Ctrl+â†’ åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè§†é¢‘
#    - ç»§ç»­æ ‡æ³¨ï¼Œæ— éœ€é€€å‡º
```

#### åœºæ™¯2ï¼šè·³è½¬æŸ¥çœ‹ç‰¹å®šè§†é¢‘

```bash
# 1. ä»ä»»æ„è§†é¢‘å¯åŠ¨
python labeling_launcher.py --match_dir data/test/match1

# 2. ä½¿ç”¨ Ctrl+â†’ å¿«é€Ÿè·³è½¬åˆ°ç›®æ ‡è§†é¢‘
# 3. å®Œæˆæ ‡æ³¨åæŒ‰ Q é€€å‡º
```

---

## æŸ¥çœ‹æ¨¡å¼ ğŸ†•

### é—®é¢˜ï¼šå·²æ ‡æ³¨å®Œæˆåæ— æ³•æŸ¥çœ‹

å½“matchä¸­æ‰€æœ‰æ–‡ä»¶éƒ½å·²æ ‡æ³¨å®Œæˆæ—¶ï¼Œä½¿ç”¨æ™®é€šæ¨¡å¼ä¼šç›´æ¥é€€å‡ºï¼š

```bash
$ python labeling_launcher.py --match_dir data/test/match1

Found 11 CSV files in data/test/match1\csv
Labeled: 11
Pending: 0
All files have been labeled!

Tip: Use --review flag to view/modify labeled files
```

### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æŸ¥çœ‹æ¨¡å¼

```bash
python labeling_launcher.py --match_dir data/test/match1 --review
```

### æŸ¥çœ‹æ¨¡å¼ç‰¹æ€§

#### 1. åŠ è½½å·²æœ‰æ ‡æ³¨

- âœ… è‡ªåŠ¨åŠ è½½ä¿å­˜çš„æ ‡æ³¨æ–‡ä»¶ï¼ˆ`*_labels.json`ï¼‰
- âœ… æ˜¾ç¤ºæ‰€æœ‰å·²ç¡®è®¤çš„äº‹ä»¶
- âœ… ä¸ä¼šé‡æ–°è¿è¡ŒPhase 1æ£€æµ‹

#### 2. è§†é¢‘å¯¼èˆªä¿æŒæ¨¡å¼

åœ¨æŸ¥çœ‹æ¨¡å¼ä¸‹ä½¿ç”¨ `Ctrl+â†` / `Ctrl+â†’` æ—¶ï¼š

- âœ… è‡ªåŠ¨åŠ è½½æ¯ä¸ªè§†é¢‘çš„å·²æœ‰æ ‡æ³¨
- âœ… æ˜¾ç¤º `[Labeled]` çŠ¶æ€æ ‡è®°
- âœ… æ— éœ€é‡æ–°æ ‡æ³¨å³å¯å¿«é€Ÿæµè§ˆ

```
è¾“å‡ºç¤ºä¾‹ï¼š
[Switch Video] [Labeled] Loaded: match1/1_05_03 (2/11)
Loaded 32 events from data/test/match1\labels\1_05_03_labels.json
```

#### 3. æ”¯æŒä¿®æ”¹å’Œé‡æ–°ä¿å­˜

åœ¨æŸ¥çœ‹æ¨¡å¼ä¸‹ä»ç„¶å¯ä»¥ï¼š

- âœ… ä¿®æ”¹ç°æœ‰äº‹ä»¶ï¼ˆç¡®è®¤ã€åˆ é™¤ã€æ›´æ”¹ç±»å‹ï¼‰
- âœ… æ·»åŠ æ–°äº‹ä»¶
- âœ… ä¿å­˜ä¿®æ”¹ï¼ˆ`S` æˆ– `Ctrl+S`ï¼‰
- âœ… åˆ‡æ¢åˆ°å…¶ä»–è§†é¢‘

### æŸ¥çœ‹æ¨¡å¼ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šæ£€æŸ¥æ ‡æ³¨è´¨é‡

```bash
# å¯åŠ¨æŸ¥çœ‹æ¨¡å¼
python labeling_launcher.py --match_dir data/test/match1 --review

# åœ¨å·¥å…·ä¸­ï¼š
# - ä½¿ç”¨ Ctrl+â†’ å¿«é€Ÿæµè§ˆæ‰€æœ‰è§†é¢‘
# - ä½¿ç”¨ â†‘/â†“ æ£€æŸ¥æ¯ä¸ªäº‹ä»¶
# - å‘ç°é—®é¢˜æ—¶ä¿®æ”¹å¹¶ä¿å­˜
```

#### åœºæ™¯2ï¼šä¿®æ­£é”™è¯¯æ ‡æ³¨

```bash
# 1. è¿›å…¥æŸ¥çœ‹æ¨¡å¼
python labeling_launcher.py --match_dir data/test/match1 --review

# 2. å¯¼èˆªåˆ°æœ‰é—®é¢˜çš„è§†é¢‘
# 3. åˆ é™¤é”™è¯¯äº‹ä»¶ï¼ˆDeleteï¼‰æˆ–ä¿®æ”¹ç±»å‹ï¼ˆL/H/Oï¼‰
# 4. ä¿å­˜ä¿®æ”¹ï¼ˆSï¼‰
# 5. ç»§ç»­æ£€æŸ¥å…¶ä»–è§†é¢‘ï¼ˆCtrl+â†’ï¼‰
```

#### åœºæ™¯3ï¼šå¯¼å‡ºå‰æœ€åæ£€æŸ¥

```bash
# 1. å…¨é¢æ£€æŸ¥æ‰€æœ‰æ ‡æ³¨
python labeling_launcher.py --match_dir data/test/match1 --review

# 2. ç¡®è®¤æ— è¯¯åå¯¼å‡º
python labeling_launcher.py --export data/test/match1/labels --output training.csv
```

### æ¨¡å¼å¯¹æ¯”

| åŠŸèƒ½                 | æ™®é€šæ¨¡å¼       | æŸ¥çœ‹æ¨¡å¼ (`--review`) |
| -------------------- | -------------- | ----------------------- |
| **å¤„ç†çš„æ–‡ä»¶** | æœªæ ‡æ³¨çš„æ–‡ä»¶   | å·²æ ‡æ³¨çš„æ–‡ä»¶            |
| **è‡ªåŠ¨æ£€æµ‹**   | âœ… è¿è¡ŒPhase 1 | âŒ ä¸è¿è¡Œ               |
| **åŠ è½½æ ‡æ³¨**   | âŒ ä¸åŠ è½½      | âœ… è‡ªåŠ¨åŠ è½½             |
| **è§†é¢‘åˆ‡æ¢**   | é‡æ–°æ£€æµ‹       | åŠ è½½å·²æœ‰æ ‡æ³¨            |
| **å¯ä»¥ä¿®æ”¹**   | âœ… å¯ä»¥        | âœ… å¯ä»¥                 |
| **çŠ¶æ€æ ‡è®°**   | `[New]`      | `[Labeled]`           |
| **é€‚ç”¨åœºæ™¯**   | æ–°æ ‡æ³¨         | æŸ¥çœ‹/ä¿®æ”¹/æ£€æŸ¥          |

---

## ç•Œé¢è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ¸ ç¾½æ¯›çƒè½ç‚¹æ£€æµ‹æ ‡æ³¨å·¥å…· v2.1                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       â”‚            â”‚            â”‚                       â”‚
â”‚    è§†é¢‘å¸§ / è½¨è¿¹å›¾     â”‚  ä¿¡æ¯é¢æ¿   â”‚  äº‹ä»¶åˆ—è¡¨  â”‚    å¿«æ·é”®é¢æ¿         â”‚
â”‚                       â”‚            â”‚            â”‚                       â”‚
â”‚  - å½“å‰å¸§ç”»é¢          â”‚ â•”â•â•â•â•â•â•â•â•—  â”‚ â•”â•â•â•â•â•â•â•â•—  â”‚  â•”â•â•â•â•â•â•â•â•—            â”‚
â”‚  - è½¨è¿¹çº¿ï¼ˆæ¸å˜ç»¿ï¼‰    â”‚ â•‘Match  â•‘  â”‚ â•‘äº‹ä»¶   â•‘  â”‚  â•‘å¿«æ·é”® â•‘            â”‚
â”‚  - çƒä½ç½®ï¼ˆé»„è‰²å…‰æ™•ï¼‰  â”‚ â•‘Video  â•‘  â”‚ â• â•â•â•â•â•â•â•â•£  â”‚  â• â•â•â•â•â•â•â•â•£            â”‚
â”‚  - äº‹ä»¶æ ‡è®°           â”‚ â•‘[1/11] â•‘  â”‚ â•‘åˆ—è¡¨   â•‘  â”‚  â•‘å¯¼èˆª   â•‘            â”‚
â”‚    â˜… è½åœ° â—† å‡»æ‰“      â”‚ â• â•â•â•â•â•â•â•â•£  â”‚ â•‘       â•‘  â”‚  â•‘è§†é¢‘ğŸ†• â•‘            â”‚
â”‚    âœ• å‡ºç”» â–  å…¶ä»–      â”‚ â•‘å¸§ä¿¡æ¯ â•‘  â”‚ â•‘ â–¶å½“å‰  â•‘  â”‚  â•‘ç¼–è¾‘   â•‘            â”‚
â”‚                       â”‚ â• â•â•â•â•â•â•â•â•£  â”‚ â•šâ•â•â•â•â•â•â•â•  â”‚  â•‘ç³»ç»Ÿ   â•‘            â”‚
â”‚                       â”‚ â•‘å½“å‰   â•‘  â”‚            â”‚  â•šâ•â•â•â•â•â•â•â•            â”‚
â”‚                       â”‚ â•‘äº‹ä»¶   â•‘  â”‚            â”‚                       â”‚
â”‚                       â”‚ â• â•â•â•â•â•â•â•â•£  â”‚            â”‚                       â”‚
â”‚                       â”‚ â•‘ç»Ÿè®¡   â•‘  â”‚            â”‚                       â”‚
â”‚                       â”‚ â•šâ•â•â•â•â•â•â•â•  â”‚            â”‚                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚    ğŸ“ˆ X/Y åæ ‡å›¾       â”‚    ğŸš€ é€Ÿåº¦/åŠ é€Ÿåº¦å›¾    â”‚    ğŸ® æŒ‰é’®åŒºåŸŸ        â”‚
â”‚                       â”‚                       â”‚   << PrevVid ğŸ†•       â”‚
â”‚                       â”‚                       â”‚   NextVid >> ğŸ†•       â”‚
â”‚                       â”‚                       â”‚   å…¶ä»–æŒ‰é’®...          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          çŠ¶æ€æ : Match: match1 | Video: 1_05_02 [1/11] ğŸ†•               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å›¾æ ‡è¯´æ˜

| æ ‡è®°             | å«ä¹‰           |
| ---------------- | -------------- |
| ğŸŸ¡ é»„è‰²åœ†åœˆ+å…‰æ™• | å½“å‰å¸§çƒçš„ä½ç½® |
| â˜… çº¢è‰²æ˜Ÿå·      | è½åœ°ç‚¹äº‹ä»¶     |
| â—† é’ç»¿è±å½¢      | å‡»çƒç‚¹äº‹ä»¶     |
| âœ• ç°è‰²å‰å·      | å‡ºç”»é¢äº‹ä»¶     |
| â–  æ©™é»„æ–¹å—      | å…¶ä»–äº‹ä»¶       |
| å®å¿ƒå›¾æ ‡         | å·²ç¡®è®¤äº‹ä»¶     |
| ç©ºå¿ƒå›¾æ ‡         | æœªç¡®è®¤äº‹ä»¶     |
| â–¶ ç®­å¤´æŒ‡ç¤º      | å½“å‰é€‰ä¸­çš„äº‹ä»¶ |

---

## å¿«æ·é”®

### å¸§å¯¼èˆª

| å¿«æ·é”®         | åŠŸèƒ½     | è¯´æ˜                 |
| -------------- | -------- | -------------------- |
| `â†` / `A` | ä¸Šä¸€å¸§   | åé€€ä¸€å¸§             |
| `â†’` / `D` | ä¸‹ä¸€å¸§   | å‰è¿›ä¸€å¸§             |
| `â†‘` / `W` | ä¸Šä¸€äº‹ä»¶ | è·³è½¬åˆ°ä¸Šä¸€ä¸ªæ£€æµ‹äº‹ä»¶ |
| `â†“`         | ä¸‹ä¸€äº‹ä»¶ | è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ£€æµ‹äº‹ä»¶ |
| `Home`       | ç¬¬ä¸€å¸§   | è·³è½¬åˆ°è§†é¢‘å¼€å¤´       |
| `End`        | æœ€åä¸€å¸§ | è·³è½¬åˆ°è§†é¢‘ç»“å°¾       |
| `PageUp`     | åé€€30å¸§ | å¿«é€Ÿåé€€             |
| `PageDown`   | å‰è¿›30å¸§ | å¿«é€Ÿå‰è¿›             |

### ğŸ†• è§†é¢‘å¯¼èˆª

| å¿«æ·é”®      | åŠŸèƒ½     | è¯´æ˜                      |
| ----------- | -------- | ------------------------- |
| `Ctrl+â†` | ä¸Šä¸€è§†é¢‘ | åˆ‡æ¢åˆ°matchä¸­çš„ä¸Šä¸€ä¸ªè§†é¢‘ |
| `Ctrl+â†’` | ä¸‹ä¸€è§†é¢‘ | åˆ‡æ¢åˆ°matchä¸­çš„ä¸‹ä¸€ä¸ªè§†é¢‘ |

> ğŸ’¡ **æç¤º**: åˆ‡æ¢è§†é¢‘å‰ä¼šæç¤ºä¿å­˜å½“å‰ä¿®æ”¹

### äº‹ä»¶ç¼–è¾‘

| å¿«æ·é”®                     | åŠŸèƒ½     | è¯´æ˜                         |
| -------------------------- | -------- | ---------------------------- |
| `Y`                      | ç¡®è®¤äº‹ä»¶ | å°†å½“å‰äº‹ä»¶æ ‡è®°ä¸ºå·²ç¡®è®¤       |
| `Delete` / `Backspace` | åˆ é™¤äº‹ä»¶ | åˆ é™¤å½“å‰å¸§çš„äº‹ä»¶             |
| `L`                      | è½åœ°ç‚¹   | è®¾ç½®/æ·»åŠ ä¸º Landing          |
| `H`                      | å‡»çƒç‚¹   | è®¾ç½®/æ·»åŠ ä¸º Hit              |
| `O`                      | å‡ºç”»é¢   | è®¾ç½®/æ·»åŠ ä¸º Out-of-frame     |
| `N`                      | æ–°å»ºäº‹ä»¶ | åœ¨å½“å‰å¸§æ·»åŠ äº‹ä»¶ï¼ˆé»˜è®¤è½åœ°ï¼‰ |

### ç³»ç»Ÿ

| å¿«æ·é”®             | åŠŸèƒ½ | è¯´æ˜                 |
| ------------------ | ---- | -------------------- |
| `S` / `Ctrl+S` | ä¿å­˜ | ä¿å­˜æ ‡æ³¨åˆ° JSON æ–‡ä»¶ |
| `Q` / `Esc`    | é€€å‡º | é€€å‡ºç¨‹åºï¼ˆæç¤ºä¿å­˜ï¼‰ |

> âš ï¸ **æ³¨æ„**: `D` é”®ç”¨äºå¯¼èˆªï¼ˆä¸‹ä¸€å¸§ï¼‰ï¼Œä¸æ˜¯åˆ é™¤ã€‚åˆ é™¤è¯·ä½¿ç”¨ `Delete` æˆ– `Backspace`ã€‚

---

## æ•°æ®æ ¼å¼

### æ ‡æ³¨æ–‡ä»¶ (JSON)

```json
{
  "metadata": {
    "video_path": "data/test/match1/video/1_05_02.mp4",
    "csv_path": "data/test/match1/csv/1_05_02_ball.csv",
    "total_frames": 517,
    "fps": 30,
    "labeled_at": "2026-01-21T15:30:00"
  },
  "events": [
    {
      "frame": 30,
      "x": 481.0,
      "y": 385.0,
      "event_type": "hit",
      "rule": "vy_reversal",
      "confidence": 0.8,
      "confirmed": true,
      "features": {
        "vy_before": -21.0,
        "vy_after": 179.0
      }
    },
    {
      "frame": 516,
      "x": 652.0,
      "y": 698.0,
      "event_type": "landing",
      "rule": "trajectory_end",
      "confidence": 0.88,
      "confirmed": true,
      "features": {}
    }
  ]
}
```

> æ³¨ï¼š`confidence` ç”±è§„åˆ™è‡ªåŠ¨ä¼°è®¡ï¼Œä¸åŒè§„åˆ™çš„ç½®ä¿¡åº¦åŒºé—´ä¸åŒï¼Œé™æ­¢è½åœ°é€šå¸¸æ›´é«˜ã€‚

### å¯¼å‡ºæ ¼å¼ (CSV)

```csv
rally,frame,x,y,event_type,confidence
1_05_02,30,481.0,385.0,hit,1.0
1_05_02,72,718.0,436.0,hit,1.0
1_05_02,516,652.0,698.0,landing,1.0
```

---

## æ‰¹é‡æ ‡æ³¨

### æ ‡æ³¨æœªå®Œæˆçš„æ–‡ä»¶ï¼ˆæ™®é€šæ¨¡å¼ï¼‰

```bash
# å¯åŠ¨æ‰¹é‡æ ‡æ³¨
python labeling_launcher.py --match_dir data/test/match1

# è‡ªåŠ¨æ˜¾ç¤ºå¾…æ ‡æ³¨æ–‡ä»¶åˆ—è¡¨
# Found 11 CSV files
# Labeled: 3
# Pending: 8
#
# é€ä¸ªæ ‡æ³¨å¾…å¤„ç†çš„æ–‡ä»¶
# æ¯ä¸ªæ–‡ä»¶æ ‡æ³¨å®Œæˆåè‡ªåŠ¨ä¿å­˜
# è¯¢é—®æ˜¯å¦ç»§ç»­ä¸‹ä¸€ä¸ª
```

### ğŸ†• æŸ¥çœ‹å·²å®Œæˆçš„æ–‡ä»¶ï¼ˆæŸ¥çœ‹æ¨¡å¼ï¼‰

```bash
# å¯åŠ¨æŸ¥çœ‹æ¨¡å¼
python labeling_launcher.py --match_dir data/test/match1 --review

# æ˜¾ç¤ºå·²æ ‡æ³¨æ–‡ä»¶
# [Review Mode] Will review 11 labeled files
#
# é€ä¸ªæ‰“å¼€å·²æ ‡æ³¨æ–‡ä»¶
# å¯ä»¥æŸ¥çœ‹ã€ä¿®æ”¹ã€é‡æ–°ä¿å­˜
# ä½¿ç”¨ Ctrl+â†/â†’ åœ¨è§†é¢‘é—´å¯¼èˆª
```

### æ‰¹é‡æ ‡æ³¨æµç¨‹å¯¹æ¯”

#### æ™®é€šæ¨¡å¼ï¼ˆæ–°æ ‡æ³¨ï¼‰

```
1. å¯åŠ¨å·¥å…· â†’ æ˜¾ç¤ºå¾…æ ‡æ³¨æ–‡ä»¶åˆ—è¡¨
2. æ‰“å¼€ç¬¬ä¸€ä¸ªæœªæ ‡æ³¨æ–‡ä»¶
3. Phase 1 è‡ªåŠ¨æ£€æµ‹é¢„å¡«å……
4. æ‰‹åŠ¨ç¡®è®¤/ä¿®æ”¹äº‹ä»¶
5. ä¿å­˜å¹¶è¯¢é—®æ˜¯å¦ç»§ç»­
6. é‡å¤æ­¥éª¤2-5ç›´åˆ°å®Œæˆ
```

#### æŸ¥çœ‹æ¨¡å¼ï¼ˆå·²æ ‡æ³¨ï¼‰

```
1. å¯åŠ¨å·¥å…· â†’ æ˜¾ç¤ºå·²æ ‡æ³¨æ–‡ä»¶åˆ—è¡¨
2. æ‰“å¼€ç¬¬ä¸€ä¸ªå·²æ ‡æ³¨æ–‡ä»¶
3. åŠ è½½å·²ä¿å­˜çš„æ ‡æ³¨
4. æŸ¥çœ‹/ä¿®æ”¹äº‹ä»¶
5. ä¿å­˜å¹¶è¯¢é—®æ˜¯å¦ç»§ç»­
6. é‡å¤æ­¥éª¤2-5
```

### æŒ‡å®šè¾“å‡ºç›®å½•

```bash
python labeling_launcher.py --match_dir data/test/match1 \
                            --output_dir my_labels/match1
```

---

## å¯¼å‡ºè®­ç»ƒæ•°æ®

### å¯¼å‡ºæ‰€æœ‰å·²ç¡®è®¤äº‹ä»¶

```bash
python labeling_launcher.py --export data/test/match1/labels \
                            --output training_events.csv
```

### æŸ¥çœ‹æ ‡æ³¨ç»Ÿè®¡

```bash
python labeling_launcher.py --stats data/test/match1/labels
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
============================================================
Labeling Statistics
============================================================
Total label files: 11
Total events: 101
Confirmed events: 85
Confirmation rate: 84.2%

By event type:
  hit: 62
  landing: 12
  out_of_frame: 11

By rally:
  1_05_02: 10/13 confirmed
  1_05_03: 8/11 confirmed
  ...
```

---

## API å‚è€ƒ

### LabelingDataManager

```python
from bounce_detection.labeling import LabelingDataManager

# åˆå§‹åŒ–
dm = LabelingDataManager(
    video_path='path/to/video.mp4',  # å¯é€‰
    csv_path='path/to/trajectory.csv',
    label_path='path/to/labels.json'  # å¯é€‰
)

# è®¿é—®æ•°æ®
frame = dm.get_frame(100)           # è·å–ç¬¬ 100 å¸§
x, y, vis = dm.get_trajectory_at_frame(100)  # è·å–è½¨è¿¹ç‚¹

# äº‹ä»¶ç®¡ç†
dm.add_event({'frame': 100, 'event_type': 'hit'})
dm.confirm_event(100)
dm.update_event(100, {'event_type': 'landing'})
dm.remove_event(100)

# ä¿å­˜
dm.save_labels('output.json')

# ç»Ÿè®¡
stats = dm.get_statistics()
```

### LabelingTool

```python
from bounce_detection.labeling import LabelingTool

# åˆå§‹åŒ–å¹¶å¯åŠ¨
tool = LabelingTool(
    csv_path='path/to/trajectory.csv',
    video_path='path/to/video.mp4',  # å¯é€‰
    auto_detect=True  # æ˜¯å¦è‡ªåŠ¨è¿è¡Œ Phase 1
)

# å¯åŠ¨äº¤äº’ç•Œé¢
events = tool.run()
```

### LabelExporter

```python
from bounce_detection.labeling.data_manager import LabelExporter

# å¯¼å‡ºä¸ºè®­ç»ƒ CSV
LabelExporter.to_training_csv(dm, 'output.csv', only_confirmed=True)

# å¯¼å‡ºäº‹ä»¶åˆ—è¡¨
LabelExporter.to_event_list(dm, 'events.csv', only_confirmed=True)
```

---

## æ–‡ä»¶ç»“æ„

```
bounce_detection/labeling/
â”œâ”€â”€ __init__.py              # æ¨¡å—å…¥å£
â”œâ”€â”€ data_manager.py          # æ•°æ®åŠ è½½/ä¿å­˜/ç®¡ç†
â”œâ”€â”€ visualizer.py            # å¯è§†åŒ–ç»„ä»¶
â”œâ”€â”€ labeling_tool.py         # ä¸»æ ‡æ³¨å·¥å…·
â””â”€â”€ README.md                # æœ¬æ–‡æ¡£

labeling_launcher.py         # å¯åŠ¨è„šæœ¬
test_labeling_tool.py        # æµ‹è¯•è„šæœ¬
```

---

## æ›´æ–°æ—¥å¿—

### v2.1.0 (2026-01-23)

**ğŸ†• æ–°åŠŸèƒ½**

- âœ¨ è§†é¢‘å¯¼èˆªï¼šæ”¯æŒåœ¨matchå†…å¿«é€Ÿåˆ‡æ¢è§†é¢‘ï¼ˆ`Ctrl+â†` / `Ctrl+â†’`ï¼‰
- âœ¨ Matchä¿¡æ¯æ˜¾ç¤ºï¼šUIå®æ—¶æ˜¾ç¤ºå½“å‰matchå’Œè§†é¢‘ä½ç½®
- âœ¨ æŸ¥çœ‹æ¨¡å¼ï¼š`--review` æ ‡å¿—ç”¨äºæŸ¥çœ‹/ä¿®æ”¹å·²æ ‡æ³¨æ–‡ä»¶
- âœ¨ æ™ºèƒ½åŠ è½½ï¼šæŸ¥çœ‹æ¨¡å¼ä¸‹è‡ªåŠ¨åŠ è½½å·²æœ‰æ ‡æ³¨ï¼Œæ™®é€šæ¨¡å¼è¿è¡Œæ£€æµ‹

**ğŸ”§ æ”¹è¿›**

- è§†é¢‘åˆ‡æ¢å‰è‡ªåŠ¨æç¤ºä¿å­˜
- æ˜¾ç¤º `[Labeled]` / `[New]` çŠ¶æ€æ ‡è®°
- ä¼˜åŒ–UIå¸ƒå±€ï¼Œæ–°å¢è§†é¢‘å¯¼èˆªæŒ‰é’®
- æ”¹è¿›å¯åŠ¨ä¿¡æ¯ï¼Œæ˜¾ç¤ºmatch/è§†é¢‘ç»Ÿè®¡

### v2.0.0 (2026-01-21)

- âœ… å®ç° LabelingDataManager æ•°æ®ç®¡ç†
- âœ… å®ç° matplotlib äº¤äº’ç•Œé¢
- âœ… æ”¯æŒ Phase 1 è‡ªåŠ¨é¢„å¡«å……
- âœ… æ”¯æŒé”®ç›˜å¿«æ·é”®æ“ä½œ
- âœ… æ”¯æŒæ‰¹é‡æ ‡æ³¨æ¨¡å¼
- âœ… æ”¯æŒ CSV/JSON å¯¼å‡º
